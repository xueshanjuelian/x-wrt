From cc321207322cee9fbff0e43a4c9ccbe955fa817b Mon Sep 17 00:00:00 2001
From: Chen Minqiang <ptpt52@gmail.com>
Date: Thu, 14 Aug 2025 23:54:07 +0800
Subject: [PATCH] dsa: disable offload

Signed-off-by: Chen Minqiang <ptpt52@gmail.com>
---
 net/dsa/switch.c | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

--- a/net/dsa/switch.c
+++ b/net/dsa/switch.c
@@ -79,7 +79,7 @@ static int dsa_switch_mtu(struct dsa_swi
 	return 0;
 }
 
-static int dsa_switch_bridge_join(struct dsa_switch *ds,
+static inline int dsa_switch_bridge_join(struct dsa_switch *ds,
 				  struct dsa_notifier_bridge_info *info)
 {
 	int err;
@@ -788,7 +788,7 @@ out:
 	return err;
 }
 
-static int dsa_switch_vlan_add(struct dsa_switch *ds,
+static inline int dsa_switch_vlan_add(struct dsa_switch *ds,
 			       struct dsa_notifier_vlan_info *info)
 {
 	struct dsa_port *dp;
@@ -809,7 +809,7 @@ static int dsa_switch_vlan_add(struct ds
 	return 0;
 }
 
-static int dsa_switch_vlan_del(struct dsa_switch *ds,
+static inline int dsa_switch_vlan_del(struct dsa_switch *ds,
 			       struct dsa_notifier_vlan_info *info)
 {
 	struct dsa_port *dp;
@@ -829,7 +829,7 @@ static int dsa_switch_vlan_del(struct ds
 	return 0;
 }
 
-static int dsa_switch_host_vlan_add(struct dsa_switch *ds,
+static inline int dsa_switch_host_vlan_add(struct dsa_switch *ds,
 				    struct dsa_notifier_vlan_info *info)
 {
 	struct dsa_port *dp;
@@ -850,7 +850,7 @@ static int dsa_switch_host_vlan_add(stru
 	return 0;
 }
 
-static int dsa_switch_host_vlan_del(struct dsa_switch *ds,
+static inline int dsa_switch_host_vlan_del(struct dsa_switch *ds,
 				    struct dsa_notifier_vlan_info *info)
 {
 	struct dsa_port *dp;
@@ -982,7 +982,7 @@ static int dsa_switch_event(struct notif
 		err = dsa_switch_ageing_time(ds, info);
 		break;
 	case DSA_NOTIFIER_BRIDGE_JOIN:
-		err = dsa_switch_bridge_join(ds, info);
+		err = -EOPNOTSUPP;
 		break;
 	case DSA_NOTIFIER_BRIDGE_LEAVE:
 		err = dsa_switch_bridge_leave(ds, info);
@@ -1027,16 +1027,16 @@ static int dsa_switch_event(struct notif
 		err = dsa_switch_host_mdb_del(ds, info);
 		break;
 	case DSA_NOTIFIER_VLAN_ADD:
-		err = dsa_switch_vlan_add(ds, info);
+		err = -EOPNOTSUPP;
 		break;
 	case DSA_NOTIFIER_VLAN_DEL:
-		err = dsa_switch_vlan_del(ds, info);
+		err = -EOPNOTSUPP;
 		break;
 	case DSA_NOTIFIER_HOST_VLAN_ADD:
-		err = dsa_switch_host_vlan_add(ds, info);
+		err = -EOPNOTSUPP;
 		break;
 	case DSA_NOTIFIER_HOST_VLAN_DEL:
-		err = dsa_switch_host_vlan_del(ds, info);
+		err = -EOPNOTSUPP;
 		break;
 	case DSA_NOTIFIER_MTU:
 		err = dsa_switch_mtu(ds, info);
